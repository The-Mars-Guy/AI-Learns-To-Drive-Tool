<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#0b0b12">
  <title>Create AI (.evolution)</title>
  <link rel="stylesheet" href="create.css" />
</head>
<body>
  <div class="wrap">
    <div class="card">
      <section class="section">
        <div class="row tight" style="flex-wrap:wrap;">
          <button id="createBtn" class="btn primary">Create .evolution</button>
          <label class="row tight" style="align-items:center">
            <input id="autoLoadToggle" type="checkbox" /> Auto-load last session
          </label>
          <button id="loadSessionBtn" class="btn ghost">Load last session</button>
          <button id="clearCacheBtn" class="btn ghost">Clear saved inputs</button>
          <span id="cStatus" class="pill" role="status" aria-live="polite"></span>
        </div>
      </section>

      <section class="section">
        <h2 class="h2">Allow & Overwrite</h2>
        <div class="panel">
          <label class="row tight">
            <input type="checkbox" id="devOverride" /> Enable overrides (disable 5° snapping, customize hidden layer caps)
          </label>
          <div id="devForm" class="row wrap tight" style="margin-top:8px;opacity:.6;pointer-events:none">
            <label>
              Max total layers
              <input id="ovMaxLayers" type="number" min="3" step="1" value="20" class="btn in" />
            </label>
            <label>
              Max nodes per hidden
              <input id="ovMaxNodes" type="number" min="1" step="1" value="64" class="btn in" />
            </label>
          </div>
          <div class="hint">
            Disclaimer: Activating this section and using modified or unofficial networks may result in your progress being invalidated and removal from leaderboards.
          </div>
        </div>
      </section>

      <hr>

      <section class="section">
        <h2 class="h2">Neural Network</h2>
        <div class="split-2">
          <div class="col">
            <div class="panel">
              <div class="row tight">
                <span class="pill">Input (auto): <strong id="nnInputAuto">0</strong></span>
                <span class="pill">Output: <strong id="nnOutputCount">2</strong></span>
                <span class="pill warn" id="nnWarn" style="display:none"></span>
              </div>
              <div class="row tight" style="margin-top:6px; flex-wrap:wrap; gap:12px;">
                <label class="row tight" style="align-items:center">
                  <input type="checkbox" id="nnOutput3" /> Enable Handbrake
                </label>
                <label class="row tight" style="align-items:center">
                  <input type="checkbox" id="nnOutput4" /> Enable Brake
                </label>
              </div>
              <div id="hiddenLayers" class="panel" style="margin-top:10px"></div>
              <div class="row tight" style="margin-top:8px">
                <button id="addHidden" class="btn">Add hidden layer</button>
                <span class="pill" id="nnSummary"></span>
              </div>
              <div class="row tight wrap extras" style="margin-top:10px">
                <label><input type="checkbox" class="c-extra" value="angularVelocity"> angularVelocity</label>
                <label><input type="checkbox" class="c-extra" value="correctDirection"> correctDirection</label>
                <label><input type="checkbox" class="c-extra" value="velocityFront"> velocityFront</label>
                <label><input type="checkbox" class="c-extra" value="velocitySide"> velocitySide</label>
                <label><input type="checkbox" class="c-extra" value="speed"> speed</label>
                <label><input type="checkbox" class="c-extra" value="wheelAngle"> wheelAngle</label>
                <label><input type="checkbox" class="c-extra" value="grip"> grip</label>
              </div>
            </div>
          </div>
          <div class="col">
            <div class="visual-box">
              <div class="visual-title">Network preview</div>

              <div class="row tight" style="align-items:center; gap:12px; margin-bottom:8px;">
                <label class="row tight" style="align-items:center">
                  <input type="checkbox" id="nnXavierWeights" /> Xavier init: Weights
                </label>
                <label class="row tight" style="align-items:center">
                  <input type="checkbox" id="nnXavierBiases" /> Xavier init: Biases
                </label>
                <label class="row tight" style="align-items:center">
                  <input type="checkbox" id="nnPresetOutBias" />
                  Preset output bias [0, 0.1, -0.1, -0.1]
                </label>
              </div>

              <svg id="nnSvg" width="100%" height="420" viewBox="0 0 980 380"
                   preserveAspectRatio="xMidYMid meet" role="img" aria-label="Neural network diagram">
                <rect class="nn-raycast" x="0" y="0" width="980" height="380" fill="transparent"></rect>
              </svg>
            </div>
          </div>
        </div>
      </section>

      <hr>

      <section class="section">
        <h2 class="h2">Sensors</h2>
        <div class="hint">
          Custom raycasts only. Angle −180 → 180 (0 is up). Extras count toward input size.
          <strong>Max 13 rays.</strong>
        </div>
        <div class="split-2">
          <div class="col">
            <div class="row tight" style="margin-top:8px">
              <label>Degrees <input id="cCustomDeg" type="number" step="5" value="0" class="btn in" /></label>
              <label>Length  <input id="cCustomLen" type="number" min="0" step="1" value="900" class="btn in" /></label>
              <label class="row tight" style="align-items:center"><input id="cMirrorAdd" type="checkbox" /> Mirror</label>
            </div>
            <div class="row tight">
              <button id="cAddRay" class="btn">Add raycast</button>
              <button id="cClearRays" class="btn">Clear all</button>
              <button id="cMirrorAll" class="btn">Mirror all existing</button>
              <span id="rayCountBadge" class="pill">0 rays</span>
            </div>
            <div class="panel" id="cCustomList"></div>
          </div>
          <div class="col">
            <div class="visual-box">
              <div class="visual-title">Rays preview (0° up, +CW, −CCW)</div>
              <div class="row tight" style="margin:6px 0 8px">
                <label>Vehicle
                  <select id="vehicleKind" class="btn in">
                    <option value="formula" selected>Formula (F1)</option>
                    <option value="rally">Rally car</option>
                    <option value="snowmobile">Snowmobile</option>
                    <option value="truck">Truck</option>
                  </select>
                </label>
                <label>Scale  <input id="carImageScale" type="number" step="0.1" min="0.2" max="1.5" value="1" class="btn in" style="min-width:72px;"></label>
                <label>Angle° <input id="carImageAngle" type="number" step="1" min="-180" max="180" value="0" class="btn in" style="min-width:72px;"></label>
              </div>
              <svg id="raysSvg" width="100%" height="420" viewBox="0 0 500 300" preserveAspectRatio="xMidYMid meet" role="img" aria-label="Raycast visual"></svg>
            </div>
          </div>
        </div>
      </section>

      <section class="section" style="display:none;">
        <h2 class="h2">Meta</h2>
        <div class="row tight">
          <label>Color <select id="cColor" class="btn in"></select></label>
          <span id="colorSwatch" class="swatch" aria-hidden="true"></span>
        </div>
      </section>

      <footer class="foot">Made By Mars</footer>
    </div>
  </div>

  
  <script type="module" src="./js/app.js"></script>
</body>
</html>